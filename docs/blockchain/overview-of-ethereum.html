
<!DOCTYPE html>

<html lang="zh">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>An Overview of Ethereum &#8212; Yuqi&#39;s Notebook  文档</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="Substrate" href="Substrate.html" />
    <link rel="prev" title="Basic Concepts" href="concepts.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=light-blue data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#blockchain/overview-of-ethereum" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="Yuqi&#39;s Notebook  文档"
           class="md-header-nav__button md-logo">
          
            <i class="md-icon">&#xe409</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Yuqi's Notebook  文档</span>
          <span class="md-header-nav__topic"> An Overview of Ethereum </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/oneforalone/oneforalone.github.io/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Yuqi's Notebook
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Yuqi's Notebook  文档</a></li>
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">区块链</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Yuqi&#39;s Notebook 文档" class="md-nav__button md-logo">
      
        <i class="md-icon">&#xe409</i>
      
    </a>
    <a href="../index.html"
       title="Yuqi&#39;s Notebook 文档">Yuqi's Notebook  文档</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/oneforalone/oneforalone.github.io/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Yuqi's Notebook
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="index.html" class="md-nav__link">区块链</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="concepts.html" class="md-nav__link">Basic Concepts</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> An Overview of Ethereum </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">An Overview of Ethereum</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#blockchain-overview-of-ethereum--page-root" class="md-nav__link">An Overview of Ethereum</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id1" class="md-nav__link">序</a>
        </li>
        <li class="md-nav__item"><a href="#ethereum" class="md-nav__link">Ethereum</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id2" class="md-nav__link">定义</a>
        </li>
        <li class="md-nav__item"><a href="#overview" class="md-nav__link">Overview</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#evm" class="md-nav__link">EVM</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id3" class="md-nav__link">定义</a>
        </li>
        <li class="md-nav__item"><a href="#id4" class="md-nav__link">工作原理</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#world-state" class="md-nav__link">World state</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#account" class="md-nav__link">account</a>
        </li>
        <li class="md-nav__item"><a href="#id5" class="md-nav__link">定义</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#transaction" class="md-nav__link">Transaction</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#message" class="md-nav__link">message</a>
        </li>
        <li class="md-nav__item"><a href="#id6" class="md-nav__link">定义</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#reference" class="md-nav__link">Reference</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/blockchain/overview-of-ethereum.md.txt">显示源代码</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="Substrate.html" class="md-nav__link">Substrate</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../life/index.html" class="md-nav__link">随笔</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../life/after-work.html" class="md-nav__link">After Work</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../life/summary-of-2020.html" class="md-nav__link">Summary of 2020</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../life/rework.html" class="md-nav__link">Re-Work</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../life/my-fellows.html" class="md-nav__link">My Fellows</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../life/summary-of-2021.html" class="md-nav__link">Summary of 2021</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../programming/index.html" class="md-nav__link">编程</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../programming/c.html" class="md-nav__link">The C Promgramming Language</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../programming/rust.html" class="md-nav__link">Rust Scratch</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../mathematic/index.html" class="md-nav__link">数学</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../mathematic/calculus-formula.html" class="md-nav__link">微积分之常用公式</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../mathematic/brook-taylor.html" class="md-nav__link">泰勒公式</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../mathematic/brook-taylor.html#id2" class="md-nav__link">泰勒级数</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../linux/index.html" class="md-nav__link">Linux</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../linux/linux-staffs-01.html" class="md-nav__link">我与 Linux 的那些事01：初识</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../linux/linux-staffs-02.html" class="md-nav__link">我与 Linux 的那些事02：选择</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../linux/linux-staffs-03.html" class="md-nav__link">我与 Linux 的那些事03：命令</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/index.html" class="md-nav__link">杂项</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../misc/vb-docker-conflicts.html" class="md-nav__link">Windows 上 VirtualBox 与 Docker 冲突问题</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/freebsd-install-x11.html" class="md-nav__link">FreeBSD 12 安装图形界面</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/dual-os-date-issue.html" class="md-nav__link">Windows/Debian 双系统时间问题</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/try-on-lispworks-personal.html" class="md-nav__link">初试 LispWorks</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/docker-k8s.html" class="md-nav__link">初探 Kubernetes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/frp.html" class="md-nav__link">内网穿透 frp 配置</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/centos6-yum-repo.html" class="md-nav__link">CentOS 6 使用国内 yum 源</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/centos6-em2eth.html" class="md-nav__link">CentOS 6 网卡名 em 修改成 eth</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/vnc.html" class="md-nav__link">VNC 常见问题及解决方案</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/miscellaneous.html" class="md-nav__link">杂记</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../projects/index.html" class="md-nav__link">项目</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="https://oneforalone.github.io/cl-cookbook-cn/#/" class="md-nav__link">The CommonLisp Cookbook</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="https://oneforalone.github.io/lol-zh/" class="md-nav__link">Let Over Lambda 中文翻译</a>
      
    
    </li></ul>
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#blockchain-overview-of-ethereum--page-root" class="md-nav__link">An Overview of Ethereum</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id1" class="md-nav__link">序</a>
        </li>
        <li class="md-nav__item"><a href="#ethereum" class="md-nav__link">Ethereum</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id2" class="md-nav__link">定义</a>
        </li>
        <li class="md-nav__item"><a href="#overview" class="md-nav__link">Overview</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#evm" class="md-nav__link">EVM</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id3" class="md-nav__link">定义</a>
        </li>
        <li class="md-nav__item"><a href="#id4" class="md-nav__link">工作原理</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#world-state" class="md-nav__link">World state</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#account" class="md-nav__link">account</a>
        </li>
        <li class="md-nav__item"><a href="#id5" class="md-nav__link">定义</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#transaction" class="md-nav__link">Transaction</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#message" class="md-nav__link">message</a>
        </li>
        <li class="md-nav__item"><a href="#id6" class="md-nav__link">定义</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#reference" class="md-nav__link">Reference</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/blockchain/overview-of-ethereum.md.txt">显示源代码</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section class="tex2jax_ignore mathjax_ignore" id="an-overview-of-ethereum">
<h1 id="blockchain-overview-of-ethereum--page-root">An Overview of Ethereum<a class="headerlink" href="#blockchain-overview-of-ethereum--page-root" title="永久链接至标题">¶</a></h1>
<section id="id1">
<h2 id="id1">序<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h2>
<p>不知不觉已经进入区块链这一行有小半年了，从最开始的 <a class="reference external" href="https://www.chia.net">Chia</a>，到 <a class="reference external" href="https://www.ethswarm.org">Swarm Bee</a>，再到 <a class="reference external" href="https://phala.network/en/">Phala</a>，然后是
<a class="reference external" href="https://filecoin.io">Filcoin</a>，最后到 <a class="reference external" href="https://ethereum.org/en/">Ethereum</a>。前面的都只是在研究怎么挖，计算回本周期，最后回归到技术原理，本文试图讲解清楚
Ethereum 中的基础技术概念。</p>
<p>当然，这是篇技术性文章，所以会有一些技术层面知识的要求。同时，我并不是很想翻译，习惯下英文吧。对于一些基础的概念，参考 <a class="reference internal" href="concepts.html"><span class="doc std std-doc">Basic Concepts</span></a></p>
<p>首先简单地介绍一下 BlockChain 吧。所谓的 BlockChain 呢，就是由一个个 <strong>block</strong> 的组成的链，
每个节点都会保存一份这个链的备份。而每个 <strong>block</strong> 中都包含了多个 <strong>transaction</strong>。</p>
<p>Overview of Block:
<img alt="block.svg" src="../_images/block.svg"/></p>
<p>Block in Ethereum:
<img alt="tx-block.png" src="../_images/tx-block.png"/></p>
<blockquote>
<div><p>transaction, 中文通常叫做转账记录，但在不同的链中，对 transaction 的操作不同。所以个人还是更喜欢直接叫 transaction。</p>
</div></blockquote>
</section>
<section id="ethereum">
<h2 id="ethereum">Ethereum<a class="headerlink" href="#ethereum" title="永久链接至标题">¶</a></h2>
<section id="id2">
<h3 id="id2">定义<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h3>
<p>官网对应 Ethereum 的定义是：</p>
<blockquote>
<div><p>Ethereum is open access to digital money and data-friendly services for everyone - no matter your
background or location.</p>
</div></blockquote>
<p>这个定义介绍的是 Ethereum 的应用，并没有给出技术上的定义。</p>
<p>然后 <a class="reference external" href="https://ethereum.org/en/whitepaper/">Whitepaper</a> 上关于 Ethereum 的描述就比较冗长：</p>
<blockquote>
<div><p>The intent of Ethereum is to create an aleternative protocol for building decentralized applications,
providing a different set of tradeoffs that we believe will be very useful for a large class of decentralized
applications, with particular emphasis on situations where rapid developement time, security for small and
rarely used applications, and the ability of different applications to very efficiently interact, are important.</p>
</div></blockquote>
<p>这么一段长长的介绍，主要是阐述了 Ethereum 创建的目的以及功能特性，用这么长的一段话来定义 Ethereum 似乎不够简洁。</p>
<p>即然 <a class="reference external" href="https://ethereum.org/en/whitepaper/">Whitepaper</a> 上没找到满意的定义，那么看看 <a class="reference external" href="https://ethereum.github.io/yellowpaper/paper.pdf">Yellowpaper</a> 吧：</p>
<blockquote>
<div><p>Ethereum, taken as a whole, can be viewed as a transaction-based state machine: we begin with a genesis
state and incrementally execute transactions to morph it into some current state.</p>
</div></blockquote>
<p>欸，这里感觉有点味道了，可总觉得还是没那味。</p>
<p>所以这里根据参考的上面的资料，大胆的给 Ethereum 下个定义：</p>
<blockquote>
<div><p><em>Ethereum is decentralised database which stores transaction-based state root hashes.</em></p>
</div></blockquote>
<p>这里解释一下，其中的 <code class="docutils literal notranslate"><span class="pre">decentralised</span> <span class="pre">database</span></code> 就是区块链，区块链的本质上就是个去中心化的数据库。后面的 <code class="docutils literal notranslate"><span class="pre">transaction-based</span> <span class="pre">state</span></code>
才是 Ethereum 的核心特征。下面会介绍到什么是 <code class="docutils literal notranslate"><span class="pre">transaction</span></code>。</p>
</section>
<section id="overview">
<h3 id="overview">Overview<a class="headerlink" href="#overview" title="永久链接至标题">¶</a></h3>
<p>知道了 Ethereum 的定义，然后来看下整个以太坊的概览：</p>
<p><img alt="Overview of Ethereum.png" src="../_images/overview-of-ethereum.png"/></p>
<p>通常，技术上是将 Ethereum 代指 Ethereum network。从上图可以看出，Ethereum network 是由 Ethereum node 组成。而每个 Ethereum node
都是 EVM 和 <strong>world state</strong> 的具体实现。所以，要想了解 Ethereum，就必须了解 EVM 和 <strong>world state</strong>。那么下面开始介绍 EVM。
​</p>
</section>
</section>
<section id="evm">
<h2 id="evm">EVM<a class="headerlink" href="#evm" title="永久链接至标题">¶</a></h2>
<section id="id3">
<h3 id="id3">定义<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h3>
<p>EVM (Ethereum Virtual Machine): 定义了计算区块之间新的有效状态规则的虚拟机，是智能合约的运行环境。原文是:</p>
<blockquote>
<div><p>EVM is what defines the rules for computing a new valid state from block to block, the runtime
environment for smart contracts in Ethereum.</p>
</div></blockquote>
<p>​
EVM 的架构如下：</p>
<p><img alt="evm.png" src="../_images/evm.png"/></p>
<ul class="simple">
<li><p>stack: 256 bits * 1024 elements</p></li>
<li><p>memory: byte addressing linear memory, can be addressed at byte level, random access by stack.</p></li>
<li><p>storage (Account): presistent memory, 256 bits to 256 bit key-value store, random access by stack.</p></li>
<li><p>EVM code: bytuecode that EVM can natively exectue.</p></li>
</ul>
<p>​
从上图可以看出，EVM 的个 stack-based 的架构，计算架构模型一般有两种，stack-based 和 register-based。其主要差别在于，register-based 的效率更高，
但其设计实现的复杂程度要高，stack-based 效率相比于 register-based 不高，但实现简单。针对物理机，更倾向于 register-based 的模型，因为物理机就是要
尽可能的高效执行，而对于 VM，都是在内存中操作，效率的差别不会很大，因此更倾向于 stack-based 的模型。
​
参考自：<a class="reference external" href="https://softwareengineering.stackexchange.com/questions/244354/why-do-vms-need-to-be-stack-machines-or-register-machines-etc">why-do-vms-need-to-be-stack-machines-or-register-machines-etc</a>
​</p>
<p>或许有关于 memory 是 linear memory，但却被 stack random access 的疑惑，这里产生的疑惑是对 random access 的理解有误，random access 由可以叫做
direct access，可以可以直接定位到某个元素，对应的数据结构是数组，而 linear address 本来就是可以 random access 的。查看 geth 中 memory 得实现可知，
memroy 就是由一个字节型的数组和一个 uint64 的整型组成的。与 random access 对立的 linear access 是如果要访问，只能从头开始慢慢查找，不能直接定位到
某个位置，与之对应的数据结构是链表。
​</p>
<p>The big picture：</p>
<p><img alt="evm-layer.png" src="../_images/evm-layer.png"/></p>
<p><strong>注</strong>：上图中在 Software 和 hardware 的中间，漏掉了操作系统。
​</p>
</section>
<section id="id4">
<h3 id="id4">工作原理<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h3>
<p>​
EVM 的工作流程如下：</p>
<p><img alt="evm-execution-model.png" src="../_images/evm-execution-model.png"/></p>
<p>首先，用户将自己的智能合约编译成 EVM byte code，然后 EVM 根据 byte code 里对应的指令集，消耗一定量的 gas，在 Stack 上执行操作，期间如果需要对
storage 进行操作的话，与需要扣除一定量的 gas，同理，调用其他智能合约也需要消耗 gas。
​</p>
</section>
</section>
<section id="world-state">
<h2 id="world-state">World state<a class="headerlink" href="#world-state" title="永久链接至标题">¶</a></h2>
<p>在介绍 <strong>world state</strong> 之前，首先要介绍 <strong>account</strong>。</p>
<section id="account">
<h3 id="account">account<a class="headerlink" href="#account" title="永久链接至标题">¶</a></h3>
<p><a class="reference external" href="https://ethereum.github.io/yellowpaper/paper.pdf">Yellowpaper</a> 上的定义：</p>
<blockquote>
<div><p>Accounts have an intrinsic balance and transaciton count maintained as part of the Ethereum state.
They also have some (possibly empty) EVM Code and a (possibly empty) Storage State associated with
them.Though homogenous, it makes sense to distinguish between two practical types of account: those
with empty associated EVM Code (thus the account represents an Autonomous Object). Each Account
has a single Address that identifies it.</p>
</div></blockquote>
<p><a class="reference external" href="https://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf">Ethereum EVM Illustrated</a> 中的定义：</p>
<blockquote>
<div><p>An account is a mapping between address and account state.
An account is an object in the world state.</p>
</div></blockquote>
<p>官方文档中 <strong>account</strong> 的结构如下图所示：</p>
<p><img alt="accounts.png" src="../_images/accounts.png"/></p>
<p>因此，<a class="reference external" href="https://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf">Ethereum EVM Illustrated</a> 中的定义更为贴切。
​
​<strong>account</strong> 根据是否有 EVM Code 分为两种：</p>
<ul class="simple">
<li><p>Externally owned account (aka. EOA): 不包含智能合约的账户，其中 <code class="docutils literal notranslate"><span class="pre">storage</span> <span class="pre">hash</span></code> 和
<code class="docutils literal notranslate"><span class="pre">code</span> <span class="pre">hash</span></code> 字段为空</p></li>
<li><p>Contract account：智能合约对应的账户，<code class="docutils literal notranslate"><span class="pre">code</span> <span class="pre">hash</span></code> 字段保存的是合约代码 EVM Code 的
哈希值，在 message call 时用来定位 EVM Code，<code class="docutils literal notranslate"><span class="pre">storage</span> <span class="pre">hash</span></code> 字段保存的该账户所在 <strong>block</strong>
的 header 中的 Merkle tree 根节点的哈希值，该 Merkle tree 将 <strong>account</strong> 中的内容编码到 trie 中。
通俗点讲就是用来确定当前用户的最新状态是在哪个 <strong>block</strong> 中。
​</p></li>
</ul>
</section>
<section id="id5">
<h3 id="id5">定义<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h3>
<p><strong><em>A collection of accounts that is a mapping between address and account state.</em></strong></p>
<p>这个定义是我自己定义的，因为参考的资料的定义有些模糊。
​
<a class="reference external" href="https://ethereum.github.io/yellowpaper/paper.pdf">Yellowpaper</a> 上的定义：</p>
<blockquote>
<div><p>The world state, is a mapping between addresses ( 160-bit identifiers) and account states ( a datastructure
serialised as RLP, see Appendix B).</p>
</div></blockquote>
<p>而在 <a class="reference external" href="https://takenobu-hs.github.io/downloads/ethereum_evm_illustrated.pdf">Ethereum EVM Illustrated</a> 中 <strong>world state</strong>
和 <strong>account</strong> 的定义是完全一致的：</p>
<blockquote>
<div><p>The world state is a mapping between address and account state.</p>
</div></blockquote>
<p><strong>world state</strong> 的结构如下图所示：</p>
<p><img alt="world-state.png" src="../_images/world-state.png"/></p>
<p>从图中可以清楚的看到 <strong>world state</strong> 与 <strong>account</strong> 的差别。
​</p>
</section>
</section>
<section id="transaction">
<h2 id="transaction">Transaction<a class="headerlink" href="#transaction" title="永久链接至标题">¶</a></h2>
<p>在介绍 <strong>transaction</strong> 之前，首先要介绍 <strong>message</strong> 。
​</p>
<section id="message">
<h3 id="message">message<a class="headerlink" href="#message" title="永久链接至标题">¶</a></h3>
<p>​
这个术语的定义比较清晰，就是：</p>
<blockquote>
<div><p>Message is Data ( as a set of bytes) and Value (specified as Ether) that is passwd between two Accounts.</p>
</div></blockquote>
<p>这个定义也没什么好解释的，就是说两个账户之间进行转账就叫 <strong>message</strong>。
​
P.S. 在 Ethereum 中，Ether 表示的就是 ETH。
​</p>
</section>
<section id="id6">
<h3 id="id6">定义<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h3>
<blockquote>
<div><p>A transaction is a single cryptographically-signed instruction by External Actor.</p>
</div></blockquote>
<p><img alt="transaction.png" src="../_images/transaction.png"/></p>
<p>何为 External Actor? 不在 <strong>world state</strong> 中的就叫 Extrenal Actor。就比如说你需要创建个智能合约，
你创建你需要对 node 发送创建指令并对其签名，然后你就会得到个合约账户，对于 Ethereum 来说，
你就是 External actor，而所得到的合约账户已经记录在 <strong>world state</strong> 中了，那他就不是 External Actor。
还有就是你要用一个 EOA 向另一个 EOA 转账，你是 Extrenal Actor，EOA 不是。而如果是由智能合约
触发的对 EOA 的转账，那就叫 <strong>message</strong>，而不能叫 <strong>transaction</strong>。而这，又将 <strong>transaction</strong> 分成了两种：
​</p>
<ul class="simple">
<li><p>contract creation： 对应第一种情况，创建智能合约时的 <strong>transaction</strong></p></li>
</ul>
<p><img alt="tx-contract-creation.png" src="../_images/tx-contract-creation.png"/></p>
<ul class="simple">
<li><p>message call：对应第二种情况，External Actor 用一个 EOA 给另一个 EOA 转账的 <strong>transaction</strong></p></li>
</ul>
<p><img alt="tx-message-call.png" src="../_images/tx-message-call.png"/></p>
<p>那 <strong>transaction</strong> 和 <strong>message</strong> 之间的关系是什么呢？其实就是每个 <strong>transaction</strong> ​都至少会触发一个 <strong>message</strong>，
而每个 <strong>trasaction</strong> 都会封装到 block 中，每个 block 会保存到 Ethereum Network 中，将 block 保存到 Ethereum
Network 中的这个操作通常称为<em>上链</em>。</p>
<p>至此，对于 Ethereum 里的大部分概念算是理清了。</p>
</section>
</section>
<section id="reference">
<h2 id="reference">Reference<a class="headerlink" href="#reference" title="永久链接至标题">¶</a></h2>
<ol class="simple">
<li><p><a class="reference external" href="https://ethereum.org/en/">Ethereum.org</a></p></li>
<li><p><a class="reference external" href="https://ethereum.org/en/whitepaper/">Ethereum Whitepaper</a></p></li>
<li><p><a class="reference external" href="https://ethereum.github.io/yellowpaper/paper.pdf">Ethereum: A Secure Decentralised Generalised Transaction Ledger</a></p></li>
</ol>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="concepts.html" title="Basic Concepts"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Basic Concepts </span>
              </div>
            </a>
          
          
            <a href="Substrate.html" title="Substrate"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Substrate </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2020-2021, Yuqi Liu.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.3.1.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>