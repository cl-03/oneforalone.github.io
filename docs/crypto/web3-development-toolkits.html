
<!DOCTYPE html>

<html lang="zh">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Smart Contract Development Toolkits &#8212; Yuqi&#39;s Blog  文档</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="GPG Suit for Apple Mail on Mac OS" href="GPG-on-Mac.html" />
    <link rel="prev" title="Rust Web3 Tutorial" href="rust-web3-tutorial.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=light-blue data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#crypto/web3-development-toolkits" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="Yuqi&#39;s Blog  文档"
           class="md-header-nav__button md-logo">
          
            <i class="md-icon">&#xe409</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Yuqi's Blog  文档</span>
          <span class="md-header-nav__topic"> Smart Contract Development Toolkits </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/oneforalone/oneforalone.github.io/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Yuqi's Blog
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Yuqi's Blog  文档</a></li>
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Crypto</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Yuqi&#39;s Blog 文档" class="md-nav__button md-logo">
      
        <i class="md-icon">&#xe409</i>
      
    </a>
    <a href="../index.html"
       title="Yuqi&#39;s Blog 文档">Yuqi's Blog  文档</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/oneforalone/oneforalone.github.io/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Yuqi's Blog
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="index.html" class="md-nav__link">Crypto</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="concepts.html" class="md-nav__link">Basic Concepts</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="overview-of-ethereum.html" class="md-nav__link">An Overview of Ethereum</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="substrate-tutorial.html" class="md-nav__link">Substrate Tutorial</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="bitcoin-on-pi.html" class="md-nav__link">Raspberry Pi 安装 bitcoin</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="rust-web3-tutorial.html" class="md-nav__link">Rust Web3 Tutorial</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Smart Contract Development Toolkits </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Smart Contract Development Toolkits</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#crypto-web3-development-toolkits--page-root" class="md-nav__link">Smart Contract Development Toolkits</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id2" class="md-nav__link">序</a>
        </li>
        <li class="md-nav__item"><a href="#hardhat" class="md-nav__link">Hardhat</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#hardhat-installation" class="md-nav__link">安装</a>
        </li>
        <li class="md-nav__item"><a href="#hardhat-usage" class="md-nav__link">使用</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#hardhat-init" class="md-nav__link">初始化</a>
        </li>
        <li class="md-nav__item"><a href="#hardhat-config" class="md-nav__link">配置</a>
        </li>
        <li class="md-nav__item"><a href="#hardhat-compile" class="md-nav__link">编译</a>
        </li>
        <li class="md-nav__item"><a href="#hardhat-deploy" class="md-nav__link">上链（部署）</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#truffle" class="md-nav__link">Truffle</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#truffle-installation" class="md-nav__link">安装</a>
        </li>
        <li class="md-nav__item"><a href="#truffle-usage" class="md-nav__link">使用</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#truffle-init" class="md-nav__link">初始化</a>
        </li>
        <li class="md-nav__item"><a href="#truffle-config" class="md-nav__link">配置</a>
        </li>
        <li class="md-nav__item"><a href="#truffle-compile" class="md-nav__link">编译</a>
        </li>
        <li class="md-nav__item"><a href="#truffle-deploy" class="md-nav__link">部署</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#brownie" class="md-nav__link">Brownie</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#brownie-installation" class="md-nav__link">安装</a>
        </li>
        <li class="md-nav__item"><a href="#brownie-usage" class="md-nav__link">使用</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#brownie-init" class="md-nav__link">初始化</a>
        </li>
        <li class="md-nav__item"><a href="#brownie-config" class="md-nav__link">配置</a>
        </li>
        <li class="md-nav__item"><a href="#brownie-compile" class="md-nav__link">编译</a>
        </li>
        <li class="md-nav__item"><a href="#brownie-deploy" class="md-nav__link">部署</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#foundry" class="md-nav__link">Foundry</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#foundry-installation" class="md-nav__link">安装</a>
        </li>
        <li class="md-nav__item"><a href="#foundry-usage" class="md-nav__link">使用</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#foundry-init" class="md-nav__link">初始化</a>
        </li>
        <li class="md-nav__item"><a href="#foundry-config" class="md-nav__link">配置</a>
        </li>
        <li class="md-nav__item"><a href="#foundry-compile" class="md-nav__link">编译</a>
        </li>
        <li class="md-nav__item"><a href="#foundry-deploy" class="md-nav__link">部署</a>
        </li>
        <li class="md-nav__item"><a href="#id31" class="md-nav__link">交互</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id32" class="md-nav__link">总结</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/crypto/web3-development-toolkits.md.txt">显示源代码</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="GPG-on-Mac.html" class="md-nav__link">GPG Suit for Apple Mail on Mac OS</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dive-into-bitcoin.html" class="md-nav__link">Dive into Bitcoin</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../life/index.html" class="md-nav__link">随笔</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../life/after-work.html" class="md-nav__link">After Work</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../life/summary-of-2020.html" class="md-nav__link">Summary of 2020</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../life/rework.html" class="md-nav__link">Re-Work</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../life/my-fellows.html" class="md-nav__link">My Fellows</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../life/summary-of-2021.html" class="md-nav__link">Summary of 2021</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../programming/index.html" class="md-nav__link">编程</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../programming/hacking-in-c.html" class="md-nav__link">Hacking in C</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../programming/hacking-in-rust.html" class="md-nav__link">Hacking in Rust</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../programming/hacking-in-lisp.html" class="md-nav__link">Hacking in Lisp</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../programming/hacking-in-golang.html" class="md-nav__link">Hacking in Golang</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../mathematic/index.html" class="md-nav__link">数学</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../mathematic/calculus-formula.html" class="md-nav__link">微积分之常用公式</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../mathematic/brook-taylor.html" class="md-nav__link">泰勒公式</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../mathematic/brook-taylor.html#id2" class="md-nav__link">泰勒级数</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../linux/index.html" class="md-nav__link">Linux</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../linux/linux-staffs-01.html" class="md-nav__link">我与 Linux 的那些事01：初识</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../linux/linux-staffs-02.html" class="md-nav__link">我与 Linux 的那些事02：选择</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../linux/linux-staffs-03.html" class="md-nav__link">我与 Linux 的那些事03：命令</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/index.html" class="md-nav__link">杂项</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../misc/vb-docker-conflicts.html" class="md-nav__link">Windows 上 VirtualBox 与 Docker 冲突问题</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/freebsd-install-x11.html" class="md-nav__link">FreeBSD 12 安装图形界面</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/dual-os-date-issue.html" class="md-nav__link">Windows/Debian 双系统时间问题</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/try-on-lispworks-personal.html" class="md-nav__link">初试 LispWorks</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/docker-k8s.html" class="md-nav__link">初探 Kubernetes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/frp.html" class="md-nav__link">内网穿透 frp 配置</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/centos6-yum-repo.html" class="md-nav__link">CentOS 6 使用国内 yum 源</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/centos6-em2eth.html" class="md-nav__link">CentOS 6 网卡名 em 修改成 eth</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/vnc.html" class="md-nav__link">VNC 常见问题及解决方案</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/miscellaneous.html" class="md-nav__link">杂记</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/macos.html" class="md-nav__link">MacOS 使用记录</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/raspberry-pi-4b.html" class="md-nav__link">树莓派 4B</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../misc/git-with-gpg.html" class="md-nav__link">Using GPG signing key in git</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../projects/index.html" class="md-nav__link">项目</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="https://oneforalone.github.io/cl-cookbook-cn/#/" class="md-nav__link">The CommonLisp Cookbook</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="https://oneforalone.github.io/lol-zh/" class="md-nav__link">Let Over Lambda 中文翻译</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../about-me.html" class="md-nav__link">About Me</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#crypto-web3-development-toolkits--page-root" class="md-nav__link">Smart Contract Development Toolkits</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id2" class="md-nav__link">序</a>
        </li>
        <li class="md-nav__item"><a href="#hardhat" class="md-nav__link">Hardhat</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#hardhat-installation" class="md-nav__link">安装</a>
        </li>
        <li class="md-nav__item"><a href="#hardhat-usage" class="md-nav__link">使用</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#hardhat-init" class="md-nav__link">初始化</a>
        </li>
        <li class="md-nav__item"><a href="#hardhat-config" class="md-nav__link">配置</a>
        </li>
        <li class="md-nav__item"><a href="#hardhat-compile" class="md-nav__link">编译</a>
        </li>
        <li class="md-nav__item"><a href="#hardhat-deploy" class="md-nav__link">上链（部署）</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#truffle" class="md-nav__link">Truffle</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#truffle-installation" class="md-nav__link">安装</a>
        </li>
        <li class="md-nav__item"><a href="#truffle-usage" class="md-nav__link">使用</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#truffle-init" class="md-nav__link">初始化</a>
        </li>
        <li class="md-nav__item"><a href="#truffle-config" class="md-nav__link">配置</a>
        </li>
        <li class="md-nav__item"><a href="#truffle-compile" class="md-nav__link">编译</a>
        </li>
        <li class="md-nav__item"><a href="#truffle-deploy" class="md-nav__link">部署</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#brownie" class="md-nav__link">Brownie</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#brownie-installation" class="md-nav__link">安装</a>
        </li>
        <li class="md-nav__item"><a href="#brownie-usage" class="md-nav__link">使用</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#brownie-init" class="md-nav__link">初始化</a>
        </li>
        <li class="md-nav__item"><a href="#brownie-config" class="md-nav__link">配置</a>
        </li>
        <li class="md-nav__item"><a href="#brownie-compile" class="md-nav__link">编译</a>
        </li>
        <li class="md-nav__item"><a href="#brownie-deploy" class="md-nav__link">部署</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#foundry" class="md-nav__link">Foundry</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#foundry-installation" class="md-nav__link">安装</a>
        </li>
        <li class="md-nav__item"><a href="#foundry-usage" class="md-nav__link">使用</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#foundry-init" class="md-nav__link">初始化</a>
        </li>
        <li class="md-nav__item"><a href="#foundry-config" class="md-nav__link">配置</a>
        </li>
        <li class="md-nav__item"><a href="#foundry-compile" class="md-nav__link">编译</a>
        </li>
        <li class="md-nav__item"><a href="#foundry-deploy" class="md-nav__link">部署</a>
        </li>
        <li class="md-nav__item"><a href="#id31" class="md-nav__link">交互</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id32" class="md-nav__link">总结</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/crypto/web3-development-toolkits.md.txt">显示源代码</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="smart-contract-development-toolkits">
<span id="id1"></span><h1 id="crypto-web3-development-toolkits--page-root">Smart Contract Development Toolkits<a class="headerlink" href="#crypto-web3-development-toolkits--page-root" title="永久链接至标题">¶</a></h1>
<p>Date: Wed Apr. 13 2022</p>
<section id="id2">
<h2 id="id2">序<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<p>智能合约，目前公认的是 Ethereum 上的定义，可以简单的理解为运行在
Ethereum 中 EVM 上的程序，推广一下就是运行在分布式系统上的程序。</p>
<p>而一个程序的开发过程，不外乎来说有三步：编写源代码，编译以及链接。</p>
<p>通常来说，编译和链接都是有一个工具完成的，而对于区块链来说，链接
对应的是上链（我喜欢这么叫，反正就是将编译出来的 EVM 字节码发布
到区块链上），而上链设计到网络交互，这个差异就导致了编译和链接是
由不同的工具完成。</p>
<p>当然，官方有提供 IDE —— Remix，使用也很简单，但是相信我，作为一个
学习者，使用 IDE 不是个好途径。（因为网络的原因，我经常会遇到要修改
一个合约代码时加载不出来，然后又要重写。所以国内的话，能不用 Remix
就不用 Remix）。出了网络的问题，还有一个就是 IDE 有时会掩盖掉一些
细节，anyway，IDE 这个问题只能说是见仁见智，反正我学习时是不喜欢。</p>
<p>以下是我了解到的智能合约开发的 toolkits。</p>
<blockquote>
<div><p>P.S. 目前我所指得智能合约均指代的是 Etheruem 生态的智能合约，不涉及
NEAR 和 SOLONA 这些链的智能合约开发（这两个链最好还是先把 Rust 学
一遍吧，因为他们的合约使用 Rust 去写的）。</p>
</div></blockquote>
<p>NOTE: 因为区块链又和 "Web3" 紧密联系到一起了，所以，在开发智能合约时，
最好还是先去学一下 JavaScript(或者 NodeJS)，不然就会像我一开始学开发
智能合约一样，两眼懵逼，又要看 Solidity 的文档，还要去查 NodeJS 的文档。</p>
</section>
<section id="hardhat">
<span id="id3"></span><h2 id="hardhat">Hardhat<a class="headerlink" href="#hardhat" title="永久链接至标题">¶</a></h2>
<p>这个 toolkit 使用起来很简单，我目前使用的就是这个，但是最近准备把 Rust
用起来，准备切换到 Foundry 开发了。首先，先将官方文档的链接放出来：
https://hardhat.org/getting-started 。如果有条件的话，建议还是去看
英文文档。</p>
<section id="hardhat-installation">
<span id="id4"></span><h3 id="hardhat-installation">安装<a class="headerlink" href="#hardhat-installation" title="永久链接至标题">¶</a></h3>
<p>安装有两种选择:</p>
<ul class="simple">
<li><p>安装在对应的项目，只有进入当前项目才能使用：</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>npm install --save-dev hardhat
</pre></div>
</div>
<ul class="simple">
<li><p>安装到系统环境中，可以在系统的任意目录下使用：</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>npm install -g hardhat
</pre></div>
</div>
</section>
<section id="hardhat-usage">
<span id="id5"></span><h3 id="hardhat-usage">使用<a class="headerlink" href="#hardhat-usage" title="永久链接至标题">¶</a></h3>
<section id="hardhat-init">
<span id="id6"></span><h4 id="hardhat-init">初始化<a class="headerlink" href="#hardhat-init" title="永久链接至标题">¶</a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>npx hardhat
</pre></div>
</div>
<p>执行完这条有如下输出，会有一些配置选项：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>888    888                      888 888               888
888    888                      888 888               888
888    888                      888 888               888
8888888888  8888b.  888d888 .d88888 88888b.   8888b.  888888
888    888     "88b 888P"  d88" 888 888 "88b     "88b 888
888    888 .d888888 888    888  888 888  888 .d888888 888
888    888 888  888 888    Y88b 888 888  888 888  888 Y88b.
888    888 "Y888888 888     "Y88888 888  888 "Y888888  "Y888

👷 Welcome to Hardhat v2.9.3 👷‍

? What do you want to do? …
❯ Create a basic sample project
  Create an advanced sample project
  Create an advanced sample project that uses TypeScript
  Create an empty hardhat.config.js
  Quit
</pre></div>
</div>
<p>可以根据自己的需求进行选择，如果不知道该选哪个，直接一路按回车选默认的就好了。
默认会创建一些基础的文件（以下是除了 <code class="docutils literal notranslate"><span class="pre">node_modules</span></code> 的目录结构）：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ tree -I node_module ./
./
├── README.md
├── contracts
│   └── Greeter.sol
├── hardhat.config.js
├── package-lock.json
├── package.json
├── scripts
│   └── sample-script.js
└── test
    └── sample-test.js

3 directories, 7 files
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">contracts</span></code> 目录：存放 solidity 源代码文件</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hardhat.config.js</span></code>: Hardhat 配置文件</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scripts</span></code>: 存放部署（上链）合约的 JS 脚本文件</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">test</span></code>: 存放测试合约的 JS 脚本文件</p></li>
</ul>
<p>至于 <code class="docutils literal notranslate"><span class="pre">package-lock.json</span></code> 和 <code class="docutils literal notranslate"><span class="pre">package.json</span></code> 这两个文件是 npm 的配置文件。
主要是因为 <code class="docutils literal notranslate"><span class="pre">node_modules</span></code> 目录太大了，不会上传到 Github 上，所以别人使用你
的代码时，只要执行 <code class="docutils literal notranslate"><span class="pre">npm</span> <span class="pre">install</span></code> 就回把所以的依赖都安装好。</p>
</section>
<section id="hardhat-config">
<span id="id7"></span><h4 id="hardhat-config">配置<a class="headerlink" href="#hardhat-config" title="永久链接至标题">¶</a></h4>
<p>这里需要额外介绍一下 <code class="docutils literal notranslate"><span class="pre">hardhat.config.js</span></code> 文件，最初的文件内容为：</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">require</span><span class="p">(</span><span class="s2">"nomiclabs/hardhat-waffle"</span><span class="p">);</span>

<span class="c1">// This is a sample Hardhat task. To learn how to create your own go to</span>
<span class="c1">// https://hardhat.org/guides/create-task.html</span>
<span class="nx">task</span><span class="p">(</span><span class="s2">"accounts"</span><span class="p">,</span> <span class="s2">"Prints the list of accounts"</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">taskArgs</span><span class="p">,</span> <span class="nx">hre</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">accounts</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>

  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">account</span> <span class="k">of</span> <span class="nx">accounts</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">account</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// You need to export an object to set up your config</span>
<span class="c1">// Go to https://hardhat.org/config/ to learn more</span>

<span class="cm">/**</span>
<span class="cm"> * @type import('hardhat/config').HardhatUserConfig</span>
<span class="cm"> */</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">solidity</span><span class="o">:</span> <span class="s2">"0.8.4"</span><span class="p">,</span>
<span class="p">};</span>
</pre></div>
</div>
<p>其中配置中可以添加 <code class="docutils literal notranslate"><span class="pre">task</span></code>，上面代码中是一个打印当前配置所以的账户地址，名字叫
<code class="docutils literal notranslate"><span class="pre">accounts</span></code> —— <code class="docutils literal notranslate"><span class="pre">task</span></code> 函数中第一个参数。执行 <code class="docutils literal notranslate"><span class="pre">npx</span> <span class="pre">hardhat</span> <span class="pre">accounts</span></code> 就
是执行这个 <code class="docutils literal notranslate"><span class="pre">task</span></code> 函数。如果你喜欢的话，也可以添加一个部署（<code class="docutils literal notranslate"><span class="pre">deploy</span></code>）任务：</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">task</span><span class="p">(</span><span class="s2">"deploy"</span><span class="p">,</span> <span class="s2">"Deploying the contract"</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">taskArgs</span><span class="p">,</span> <span class="nx">hre</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="c1">// set the first account to deployer</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">deployer</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Deploying contracts with account: "</span><span class="p">,</span> <span class="nx">deployer</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Account balance: "</span><span class="p">,</span> <span class="p">(</span><span class="k">await</span> <span class="nx">deployer</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">toString</span><span class="p">());</span>

  <span class="c1">// get contract instance</span>
  <span class="kd">const</span> <span class="nx">Greeter</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="s2">"Greeter"</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">greeter</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Greeter</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="s2">"Hello, world"</span><span class="p">);</span>
  <span class="k">await</span> <span class="nx">greeter</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Greeter deployed to: "</span><span class="p">,</span> <span class="nx">greeter</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>保存后需要部署时直接执行：<code class="docutils literal notranslate"><span class="pre">npx</span> <span class="pre">hardhat</span> <span class="pre">deploy</span></code> 就可以将合约部署到链上了。
不过我不推荐，因为配置文件一旦设置好后，我基本不会去改，而部署的脚本经常要改动
的，我更喜欢在 <code class="docutils literal notranslate"><span class="pre">scripts</span></code> 目录下创建一个 <code class="docutils literal notranslate"><span class="pre">deploy.js</span></code> 的部署脚本。</p>
<p>这里稍微讲解一下脚本里的一些方法和属性：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hre.ethers.getContractFactory(Greeter"</span></code> 函数中的参数是构造一个合约
的对象，参数是 <code class="docutils literal notranslate"><span class="pre">contracts</span></code> 目录下 <code class="docutils literal notranslate"><span class="pre">.sol</span></code> 的文件名，即合约的文件名。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Greeter.deploy("Hello,</span> <span class="pre">world")</span></code>，是将合约部署到链上，其中参数就是合约
构造函数的参数，如果有多个参数的话，以逗号分隔。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">await</span> <span class="pre">greeter.deployed()</span></code>，是等待合约上链成功，因为区块打包需要一定时间。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">greeter.address</span></code>: 合约部署成功后的地址，可以去区块链的 scan 网站查看，
Ethereum 的是 https://etherscan.io。</p></li>
</ul>
<p>其实前两个方法可以合并成一段代码：</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span> <span class="nx">greeter</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">hre</span><span class="p">.</span><span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="s2">"Greeter"</span><span class="p">)</span>
                                <span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="s2">"Hello, world"</span><span class="p">);</span>
</pre></div>
</div>
<p>不过这样看起来有点乱。不优雅。</p>
<p>Whoo, 介绍完 <code class="docutils literal notranslate"><span class="pre">task</span></code> （其实也顺带介绍了部署），然后再介绍一下 <code class="docutils literal notranslate"><span class="pre">module.exports</span></code>。</p>
<p>首先是其中的第一个 key/value：<code class="docutils literal notranslate"><span class="pre">solidity:</span> <span class="pre">"0.8.4"</span></code>，这个是制定对应的 <code class="docutils literal notranslate"><span class="pre">solidity</span></code>
的版本，有一点需要注意，不同版本的 <code class="docutils literal notranslate"><span class="pre">solidity</span></code> 所支持的特性有所不同。</p>
<p>然后可以在其中添加 <code class="docutils literal notranslate"><span class="pre">network</span></code> 的配置，就是指定合约具体要部署到 Ethereum Ecosystem
上具体的那个 Network，是 <code class="docutils literal notranslate"><span class="pre">mainnet</span></code>，还是 <code class="docutils literal notranslate"><span class="pre">testnet</span></code>，还是 <code class="docutils literal notranslate"><span class="pre">sidechain</span></code>，亦或是
<code class="docutils literal notranslate"><span class="pre">layer</span> <span class="pre">2</span></code>？以下给出一些对应的 network 的配置以供参考：</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1">// solidity: "0.8.4", // depends on your solidity version</span>
  <span class="nx">solidity</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">version</span><span class="o">:</span> <span class="s2">"0.8.4"</span><span class="p">,</span>
    <span class="nx">settings</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">optimizer</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">enabled</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nx">runs</span><span class="o">:</span> <span class="mf">200</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nx">defaultNetwork</span><span class="o">:</span> <span class="s2">"rinkeby"</span><span class="p">,</span> <span class="c1">// defined below</span>
  <span class="nx">networks</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">mainnet</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">url</span><span class="o">:</span> <span class="s2">"https://xxxxxxxxxxx"</span><span class="p">,</span> <span class="c1">// your node provider link</span>
      <span class="nx">accounts</span><span class="o">:</span> <span class="p">[</span><span class="nx">privateKey1</span><span class="p">,</span> <span class="nx">privateKey2</span><span class="p">,</span> <span class="p">...],</span> <span class="c1">// this array stores your accounts' private key</span>
    <span class="p">},</span>
    <span class="nx">rinkeby</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">url</span><span class="o">:</span> <span class="s2">"https://xxxxx"</span><span class="p">,</span>
      <span class="nx">accounts</span><span class="o">:</span> <span class="p">[</span><span class="nx">privateKey1</span><span class="p">,</span> <span class="nx">privateKey2</span><span class="p">,</span> <span class="p">...],</span>
    <span class="p">},</span>
    <span class="nx">mumbai</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">url</span><span class="o">:</span> <span class="s2">"https://xxxxxxx"</span><span class="p">,</span>
      <span class="nx">accounts</span><span class="o">:</span> <span class="p">[</span><span class="nx">privateKey1</span><span class="p">,</span> <span class="nx">privateKey2</span><span class="p">,</span> <span class="p">...],</span>
    <span class="p">},</span>
  <span class="p">},</span>
  <span class="nx">paths</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">sources</span><span class="o">:</span> <span class="s2">"./contracts"</span><span class="p">,</span>
    <span class="nx">tests</span><span class="o">:</span> <span class="s2">"./test"</span><span class="p">,</span>
    <span class="nx">cache</span><span class="o">:</span> <span class="s2">"./cache"</span><span class="p">,</span>
    <span class="nx">artifacts</span><span class="o">:</span> <span class="s2">"./artifacts"</span>
  <span class="p">},</span>
  <span class="nx">mocha</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">timeout</span><span class="o">:</span> <span class="mf">40000</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">networks</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">networks</span></code> 中每个网络的 <code class="docutils literal notranslate"><span class="pre">url</span></code> 的值是节点的链接，就是说你需要去链接一个<strong>全节点</strong>，
通过这个全节点来对链进行操作，可以是第三方（如 Infura、Alchemy）提供的，也可以是
自己本地运行的，如果是本地运行的全节点，<code class="docutils literal notranslate"><span class="pre">url</span></code> 的值可以设置为：
<code class="docutils literal notranslate"><span class="pre">http://127.0.0.1:8545</span></code>。因为第三方提供的服务是有 api key 或是 token 的，所以
呢，需要进行一个封装，通用的做法是将一些私密性的配置单独存放在项目更目录下的一个文件中：
<code class="docutils literal notranslate"><span class="pre">.env</span></code>。然后代码就需要改一下，下面只展示需要修改的，若没有出现的，保持原有的不变：</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// ..., the same as before</span>
<span class="nx">require</span><span class="p">(</span><span class="s1">'dotenv'</span><span class="p">).</span><span class="nx">config</span><span class="p">();</span>
<span class="nx">require</span><span class="p">(</span><span class="s1">'@nomiclabs/hardhat-ethers'</span><span class="p">);</span>
<span class="kd">const</span> <span class="p">{</span> <span class="nx">PROVIDER_URL</span><span class="p">,</span> <span class="nx">PRIVATE_KEY</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">;</span>
<span class="c1">// or you can write like this:</span>
<span class="c1">// const PROVIDER_URL = process.env.PROVIDER_URL;</span>
<span class="c1">// const PRIVATE_KEY = process.env.PRIVATE_KEY;</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1">// ...</span>
  <span class="nx">networks</span> <span class="p">{</span>
    <span class="nx">mainnet</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">url</span><span class="o">:</span> <span class="nx">PROVIDER_URL</span><span class="p">,</span> <span class="c1">// your node provider link</span>
      <span class="nx">accounts</span><span class="o">:</span> <span class="p">[</span><span class="sb">`0x</span><span class="si">${</span><span class="nx">PRIVATE_KEY</span><span class="si">}</span><span class="sb">`</span><span class="p">],</span> <span class="c1">// this array stores your accounts' private key</span>
    <span class="p">},</span>
    <span class="nx">rinkeby</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">url</span><span class="o">:</span> <span class="nx">PROVIDER_URL</span><span class="p">,</span>
      <span class="nx">accounts</span><span class="o">:</span> <span class="p">[</span><span class="sb">`0x</span><span class="si">${</span><span class="nx">PRIVATE_KEY</span><span class="si">}</span><span class="sb">`</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="nx">mumbai</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">url</span><span class="o">:</span> <span class="nx">PROVIDER_URL</span><span class="p">,</span>
      <span class="nx">accounts</span><span class="o">:</span> <span class="p">[</span><span class="sb">`0x</span><span class="si">${</span><span class="nx">PRIVATE_KEY</span><span class="si">}</span><span class="sb">`</span><span class="p">],</span>
    <span class="p">},</span>
  <span class="p">}</span>
  <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.env</span></code> 文件里的内容为：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PROVIDER_URL</span> <span class="o">=</span> <span class="s2">"https://eth-rinkeby.alchemyapi.io/v2/123abc123abc123abc123abc123abcde"</span>
<span class="n">PRIVATE_KEY</span> <span class="o">=</span> <span class="s2">""</span> <span class="c1"># fill your own private key</span>
</pre></div>
</div>
<p>注：这里的 <code class="docutils literal notranslate"><span class="pre">PROVIDER_URL</span></code> 不同的网络对应不同的 URL，不能像上面示例一样使用同样的，
否则无法连上 full node。</p>
<p><code class="docutils literal notranslate"><span class="pre">accounts</span></code> 字段的值是一个数组，数组中是账号的私钥，这里需要在导出的私钥前面添加 <code class="docutils literal notranslate"><span class="pre">0x</span></code>
字符串。当然，如果代码要上传到 Github 上，私钥泄露的话，你这个地址基本也就废了，所以
呢，也需要放在 <code class="docutils literal notranslate"><span class="pre">.env</span></code> 文件中。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">solidity</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">solidity</span></code> 出了可以指定版本外，还可以设置编译是是否进行优化。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">path</span></code> 指定了对应的源代码文件路径，<code class="docutils literal notranslate"><span class="pre">sources</span></code> 指定合约代码路径，<code class="docutils literal notranslate"><span class="pre">tests</span></code> 指定
测试代码的路径，<code class="docutils literal notranslate"><span class="pre">cache</span></code> 指定缓存目录路径，<code class="docutils literal notranslate"><span class="pre">artifacts</span></code> 指定了合约代码编译后生
成的 abi 文件的存放路径。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mocha</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">mocha</span></code> 是执行测试时的一些配置，上面只配置了超时时间，更多的配置参考：
https://mochajs.org/#command-line-usage ，其中的参数是一致的。</p>
<p>更多相关的配置介绍，参考：https://hardhat.org/config/#path-configuration</p>
</section>
<section id="hardhat-compile">
<span id="id8"></span><h4 id="hardhat-compile">编译<a class="headerlink" href="#hardhat-compile" title="永久链接至标题">¶</a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>npx hardhat compile
</pre></div>
</div>
<p>编译没啥好介绍的，通过了就通过了，出错了就自己去修复。</p>
</section>
<section id="hardhat-deploy">
<span id="id9"></span><h4 id="hardhat-deploy">上链（部署）<a class="headerlink" href="#hardhat-deploy" title="永久链接至标题">¶</a></h4>
<p>在 <code class="docutils literal notranslate"><span class="pre">scripts</span></code> 目录下创建一个 <code class="docutils literal notranslate"><span class="pre">deploy.js</span></code>（或者你自己取个名字，我用 deploy 命名）
的文件，文件内容如下：</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span> <span class="p">{</span> <span class="nx">ethers</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"hardhat"</span><span class="p">);</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">deployer</span><span class="p">]</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">getSigners</span><span class="p">();</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Deploying contracts with the account: "</span><span class="p">,</span> <span class="nx">deployer</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Account balance: "</span><span class="p">,</span> <span class="p">(</span><span class="k">await</span> <span class="nx">deployer</span><span class="p">.</span><span class="nx">getBalance</span><span class="p">()).</span><span class="nx">toString</span><span class="p">());</span>

  <span class="kd">const</span> <span class="nx">Greeter</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">ethers</span><span class="p">.</span><span class="nx">getContractFactory</span><span class="p">(</span><span class="s2">"Greeter"</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">greeter</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Greeter</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="s2">"Hello, world"</span><span class="p">);</span>

  <span class="k">await</span> <span class="nx">greeter</span><span class="p">.</span><span class="nx">deployed</span><span class="p">();</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Contract deployed at: "</span><span class="p">,</span> <span class="nx">greeter</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">main</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">0</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mf">1</span><span class="p">);</span>
  <span class="p">})</span>
</pre></div>
</div>
<p>然后执行：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>npx hardhat run scripts/deploy.js
</pre></div>
</div>
<p>正常的话你将你的合约部署好了。后面可以加一个 <code class="docutils literal notranslate"><span class="pre">--network=&lt;network-name&gt;</span></code>
用来指定对应的网络的。</p>
<p>Update[Fir Apr. 15 2022]: 这两天又仔细瞄了一眼 Hardhat 的文档，发现 <code class="docutils literal notranslate"><span class="pre">scripts</span></code>
目录下的脚本是完全不依赖 Hardhat 的，如果使用 <code class="docutils literal notranslate"><span class="pre">web3.js</span></code>/<code class="docutils literal notranslate"><span class="pre">etheres.js</span></code> 库的话，可以
直接用 node 执行。</p>
<p>对了，忘了写怎么测试了，我测试的话直接是用的 <code class="docutils literal notranslate"><span class="pre">web3.js</span></code>，直接部署到测试网上测试的，反正
不要钱。</p>
</section>
</section>
</section>
<section id="truffle">
<span id="id10"></span><h2 id="truffle">Truffle<a class="headerlink" href="#truffle" title="永久链接至标题">¶</a></h2>
<p>Date: Fri Apr. 15 2022</p>
<p>今天试着用了一下 Truffle，发现是真的难用（可能是我水平不够），反正我不喜欢。
Truffle 基础的使用是真的简单，但是它的配置和部署不是很适合我。最主要的原因
还是，在里面需要额外多加一个 <code class="docutils literal notranslate"><span class="pre">Migrate.sol</span></code> 的合约，部署时也要先部署
<code class="docutils literal notranslate"><span class="pre">Migrate</span></code>，官网的解释是说确保安全，同时也说也可以自己去修改 <code class="docutils literal notranslate"><span class="pre">Migrate.sol</span></code>
合约。我比较喜欢 KISS( Keep It Simple and Stupid) 的准则。额外多加一个
合约，部署时就得付 gas fee，安全的话直接使用 Openzeppelin 的库就好了。
还有一个就是如果合约要引用 npm 安装的库的话，不能使用通用的引用格式。这个也让
我不太喜欢。</p>
<p>当然也不是没有优点的，那就是 truffle 可以和 ganache 直接交互，使用命令
<code class="docutils literal notranslate"><span class="pre">truffle</span> <span class="pre">develop</span></code> 或是 <code class="docutils literal notranslate"><span class="pre">truffle</span> <span class="pre">console</span></code> 就可以直接进入交互模式，
前提是需要先启动 ganache。</p>
<p>好了，介绍就说到这里了，下面简单介绍下怎么使用吧。</p>
<section id="truffle-installation">
<span id="id11"></span><h3 id="truffle-installation">安装<a class="headerlink" href="#truffle-installation" title="永久链接至标题">¶</a></h3>
<p>说到安装，在国内的环境是真的很痛苦，除非使用代理，不过代理最好是稳定一点的，
我就是因为代理稍微有点不稳定（可能是我用的设备比较多），导致出错好几次，浪费
我将近一个小时的时间。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># configure your proxy first</span>
<span class="nb">export</span> <span class="nv">https_proxy</span><span class="o">=</span>http://127.0.0.1:7890 <span class="se">\</span>
       <span class="nv">http_proxy</span><span class="o">=</span>http://127.0.0.1:7890 <span class="se">\</span>
       <span class="nv">all_proxy</span><span class="o">=</span>socks5://127.0.0.1:7890
node install -g truffle
</pre></div>
</div>
</section>
<section id="truffle-usage">
<span id="id12"></span><h3 id="truffle-usage">使用<a class="headerlink" href="#truffle-usage" title="永久链接至标题">¶</a></h3>
<section id="truffle-init">
<span id="id13"></span><h4 id="truffle-init">初始化<a class="headerlink" href="#truffle-init" title="永久链接至标题">¶</a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir my-project
truffle init
</pre></div>
</div>
</section>
<section id="truffle-config">
<span id="id14"></span><h4 id="truffle-config">配置<a class="headerlink" href="#truffle-config" title="永久链接至标题">¶</a></h4>
<p>编辑项目目录下的 <code class="docutils literal notranslate"><span class="pre">truffle-config.js</span></code>:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">networks</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">development</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">host</span><span class="o">:</span> <span class="s2">"127.0.0.1"</span><span class="p">,</span>
      <span class="nx">port</span><span class="o">:</span> <span class="mf">8545</span><span class="p">,</span>
      <span class="nx">network_id</span><span class="o">:</span> <span class="s2">"*"</span>
    <span class="p">},</span>
    <span class="nx">test</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">host</span><span class="o">:</span> <span class="s2">"127.0.0.1"</span><span class="p">,</span>
      <span class="nx">port</span><span class="o">:</span> <span class="mf">8545</span><span class="p">,</span>
      <span class="nx">network_id</span><span class="o">:</span> <span class="s2">"*"</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nx">compilers</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">solc</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">version</span><span class="o">:</span> <span class="s2">"^0.8.0"</span>
    <span class="p">}</span>
  <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
<p>上面只配置了测试开发的网络，主网的话需要配置一样，只不过是 <code class="docutils literal notranslate"><span class="pre">host</span></code> 的值设为
全节点的 IP 或 URL，和 hardhat 配置中的网络配置的 <code class="docutils literal notranslate"><span class="pre">url</span></code> 参数去掉端口的值，
然后 <code class="docutils literal notranslate"><span class="pre">port</span></code> 就写成对应的端口就好，本地的 ganache-cli 的话是 8545，ganache
GUI 版本的话端口就是 7545，如果是三方提供的全节点的话，那么就是 80/443。
或者是直接不使用 host 参数，而是使用 <code class="docutils literal notranslate"><span class="pre">provider</span></code> 参数，值设置为
<code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">Web3.providers.HttpProvider("https://&lt;host&gt;:&lt;port&gt;)</span></code>。
当然 <code class="docutils literal notranslate"><span class="pre">network</span></code> 里面也可以设置 <code class="docutils literal notranslate"><span class="pre">gas</span></code>、<code class="docutils literal notranslate"><span class="pre">gasPrice</span></code>、<code class="docutils literal notranslate"><span class="pre">from</span></code> 等参数。
详细的配置说明见：https://trufflesuite.com/docs/truffle/reference/configuration</p>
</section>
<section id="truffle-compile">
<span id="id15"></span><h4 id="truffle-compile">编译<a class="headerlink" href="#truffle-compile" title="永久链接至标题">¶</a></h4>
<p>编译很简单，直接执行 <code class="docutils literal notranslate"><span class="pre">truffle</span> <span class="pre">compile</span></code> 就可以了，编译好的 abi 文件默认存放
在 <code class="docutils literal notranslate"><span class="pre">build</span></code> 目录下。这个目录路径也可以在 <code class="docutils literal notranslate"><span class="pre">truffle-config.js</span></code> 中配置，在
其中添加一行：</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">contracts_build_directory</span><span class="o">:</span> <span class="s2">"/path/to/the/abi/output/director"</span>
</pre></div>
</div>
<p>路径自己定义，不要照抄。</p>
</section>
<section id="truffle-deploy">
<span id="id16"></span><h4 id="truffle-deploy">部署<a class="headerlink" href="#truffle-deploy" title="永久链接至标题">¶</a></h4>
<p>首先要在 <code class="docutils literal notranslate"><span class="pre">migrations</span></code> 目录下创建一个对应的脚本，一般习惯命名为
<code class="docutils literal notranslate"><span class="pre">2_deploy_contracts.js</span></code>, 因为该目录下已经有一个 <code class="docutils literal notranslate"><span class="pre">1_initial_migration.js</span></code>
文件了。这里以官方给的例子讲解：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir MetaCoin
<span class="nb">cd</span> MetaCoin
truffle unbox metacoin
truffle migrate
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">truffle</span> <span class="pre">migrate</span></code> 会自动执行 <code class="docutils literal notranslate"><span class="pre">migrations</span></code> 目录下所有的脚本。
MetaCoin 的目录结构如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ tree ./
./
├── LICENSE
├── contracts
│   ├── ConvertLib.sol
│   ├── MetaCoin.sol
│   └── Migrations.sol
├── migrations
│   ├── 1_initial_migration.js
│   └── 2_deploy_contracts.js
├── test
│   ├── TestMetaCoin.sol
│   └── metacoin.js
└── truffle-config.js

3 directories, 9 files
</pre></div>
</div>
<p>其中 <code class="docutils literal notranslate"><span class="pre">MetaCoin.sol</span></code> <code class="docutils literal notranslate"><span class="pre">import</span></code> 了 <code class="docutils literal notranslate"><span class="pre">ConvertLib.sol</span></code>。</p>
<p>MetaCoin 的 <code class="docutils literal notranslate"><span class="pre">2_deploy_contracts.js</span></code> 如下：</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span> <span class="nx">ConvertLib</span> <span class="o">=</span><span class="nx">artifacts</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">"ConvertLib"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">MetaCoin</span> <span class="o">=</span> <span class="nx">artifacts</span><span class="p">.</span><span class="nx">require</span><span class="p">(</span><span class="s2">"MetaCoin"</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">deployer</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">deployer</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">ConvertLib</span><span class="p">);</span>
  <span class="nx">deployer</span><span class="p">.</span><span class="nx">link</span><span class="p">(</span><span class="nx">ConvertLib</span><span class="p">,</span> <span class="nx">MetaCoin</span><span class="p">);</span>
  <span class="nx">deployer</span><span class="p">.</span><span class="nx">deploy</span><span class="p">(</span><span class="nx">MetaCoin</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>前两行没啥可讲的，就是导入合约的 abi，即 json 文件。然后先部署被
<code class="docutils literal notranslate"><span class="pre">import</span></code> 的合约（<code class="docutils literal notranslate"><span class="pre">ConvertLib.sol</span></code>)，将两个合约链接到一起
（<code class="docutils literal notranslate"><span class="pre">deployer.link(ConvertLib,</span> <span class="pre">MetaCoin)</span></code>，最后在部署调用其他
合约的合约。</p>
<p>这里的部署函数被完全封装起来了，我也不想去扒其中的代码了，所以不要问
<code class="docutils literal notranslate"><span class="pre">deployer</span></code> 是什么了，具体是什么我没去看源代码，不确定，但可以推测出
truffle 封装了一个根据配置文件中的一些配置生成了个
<code class="docutils literal notranslate"><span class="pre">web3.eth.Contract</span></code> 对象传进去了。所以说我不太喜欢它，封装的有点
过了，虽然我可以自己完全用 <code class="docutils literal notranslate"><span class="pre">web3.js</span></code> 写一个部署脚本，但那样的话我
为什么不用 hardhat 呢？</p>
<p>Truffle 介绍也就到这里了，最后再附上官方文档地址：
https://trufflesuite.com/docs/truffle/quickstart/</p>
<blockquote>
<div><p>P.S. truffle 还有一个槽点就是团队不怎么维护了，所以懂得都懂。</p>
</div></blockquote>
<p>Update[Sun Apr. 17 2020]: 忘了介绍怎么在 truffle 的项目中使用
第三方的合约了，这也是我吐槽的一个槽点，标准的 Solidity 语法是：
<code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">"@OpenZeppelin/contracts/token/ERC20/ERC20.sol";</span></code></p>
<p>而到了 truffle 项目中，引用是这样的：
<code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">"openzeppelin-solidity/contracts/token/ERC20/ERC20.sol";</span></code></p>
<p>所以 truffle 在引用三方的合约时，需要注意。</p>
</section>
</section>
</section>
<section id="brownie">
<span id="id17"></span><h2 id="brownie">Brownie<a class="headerlink" href="#brownie" title="永久链接至标题">¶</a></h2>
<p>Brownie，一个由 python 和 web3.py 实现的一个 toolkit，或者说
framework 吧。怎么叫随你了。其中 brownie 的优势是，其提供了 GUI
界面显示合约的 opcode，可以对合约进行 evm 级别的优化。当然，前提
是你要了解 evm 的 opcode 具体含义，这个有点 hardcore，因为 evm
的 opcode 类似于汇编语言，所以懂得都懂。</p>
<section id="brownie-installation">
<span id="id18"></span><h3 id="brownie-installation">安装<a class="headerlink" href="#brownie-installation" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3.9 -m pip install --user pipx
python3.9 -m pipx ensurepath
<span class="nb">source</span> ~/.zshrcr
pipx install eth-brownie
</pre></div>
</div>
<p><strong>注</strong>：这里需要使用 python3.9 或相近的版本，但不能高于 3.9，比如
3.10 安装会出错的。我只验证过 python3.9，3.8 和 3.7 没有验证过。</p>
</section>
<section id="brownie-usage">
<span id="id19"></span><h3 id="brownie-usage">使用<a class="headerlink" href="#brownie-usage" title="永久链接至标题">¶</a></h3>
<section id="brownie-init">
<span id="id20"></span><h4 id="brownie-init">初始化<a class="headerlink" href="#brownie-init" title="永久链接至标题">¶</a></h4>
<p>初始化项目很简单，基本命令都是通用的，就一句：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>brownie init
</pre></div>
</div>
<p>执行后会在目录下自动生成一些目录，目录结构为：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ tree ./
./
├── build
│   ├── contracts
│   ├── deployments
│   └── interfaces
├── contracts
├── interfaces
├── reports
├── scripts
└── tests

9 directories, 0 files
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">contracts</span></code>：存放合约源代码</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">interfaces</span></code>：存放合约的 interface 源代码</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scripts</span></code>：存放合约部署、交互的脚本</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tests</span></code>：存放测试脚本</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">build</span></code>：存放编译后的文件代码以及测试结果</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reports</span></code>：可选的，这里放的是 JSON 报告文件，供 GUI 中使用</p></li>
</ul>
</section>
<section id="brownie-config">
<span id="id21"></span><h4 id="brownie-config">配置<a class="headerlink" href="#brownie-config" title="永久链接至标题">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">brownie</span> <span class="pre">init</span></code> 不会像 truffle 和 hardhat 那样提供一些初始的
配置文件和示例代码，所以需要自己手动创建配置文件，配置文件名为：
<code class="docutils literal notranslate"><span class="pre">brownie-config.yaml</span></code>。</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">dependencies</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">OpenZeppelin/openzeppelin-contracts@4.1.0</span>

<span class="nt">compiler</span><span class="p">:</span>
  <span class="nt">solc</span><span class="p">:</span>
    <span class="nt">version</span><span class="p">:</span> <span class="s">'0.8.4'</span>
    <span class="nt">optimizer</span><span class="p">:</span>
      <span class="nt">enabled</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
      <span class="nt">runs</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">200</span>
    <span class="nt">remappings</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="s">'@OpenZeppelin=OpenZeppelin/openzeppelin-contracts@4.1.0'</span>

<span class="c1"># Automatically fetch contract sources from Etherscan</span>
<span class="nt">autofetch_sources</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">dotenv</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.env</span>
<span class="nt">networks</span><span class="p">:</span>
  <span class="nt">defaults</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">development</span>
  <span class="nt">development</span><span class="p">:</span>
    <span class="nt">verify</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
  <span class="nt">rinkeby</span><span class="p">:</span>
    <span class="nt">verify</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
  <span class="nt">ganache</span><span class="p">:</span>
    <span class="nt">verify</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">wallets</span><span class="p">:</span>
  <span class="nt">private_key</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${PRIVATE_KEY}</span>
  <span class="nt">mnemonic</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">${MNEMONIC}</span>
</pre></div>
</div>
<p>配置和前面的两个也是大同小异，基本的网络、编译器的配置参数基本一致，只要在
brownie 中的编译其的配置中，多了 <code class="docutils literal notranslate"><span class="pre">dependencies</span></code> 和 <code class="docutils literal notranslate"><span class="pre">remapping</span></code> 这两
个参数，这里 <code class="docutils literal notranslate"><span class="pre">dependencies</span></code> 下值是
<code class="docutils literal notranslate"><span class="pre">&lt;Github</span> <span class="pre">Name&gt;/&lt;repo-name&gt;@&lt;version&gt;</span></code>，通过这个配置 brownie 会自动
去 Github 上拉取对应的代码，然后通过 <code class="docutils literal notranslate"><span class="pre">remappings</span></code> 来映射成合约中的引用。</p>
<p>因为 <code class="docutils literal notranslate"><span class="pre">solidity</span></code> 引用三方库的标准语法是 <code class="docutils literal notranslate"><span class="pre">@OpenZeppelin/.....</span></code>，所以就
写成 <code class="docutils literal notranslate"><span class="pre">@OpenZeppelin=OpenZeppelin/openzeppelin-contracts@4.1.0</span></code></p>
<p>而 <code class="docutils literal notranslate"><span class="pre">networks</span></code> 中每个 network 的 <code class="docutils literal notranslate"><span class="pre">verify</span></code> 是用来是否是在 <code class="docutils literal notranslate"><span class="pre">etherscan.io</span></code>
上开源代码，因为默认部署后并不是开源的，而是一堆 EVM 的 OP Code。</p>
<p><code class="docutils literal notranslate"><span class="pre">dotenv</span></code> 业内通用，一些比较私密性的配置，都喜欢放到 <code class="docutils literal notranslate"><span class="pre">.env</span></code> 文件中，这里的
也需要创建一个 <code class="docutils literal notranslate"><span class="pre">.env</span></code> 文件，文件中一般需要设置为：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">WEB3_INFURA_PROJECT_ID</span><span class="o">=</span><span class="s1">''</span>
<span class="n">export</span> <span class="n">PRIVATE_KEY</span><span class="o">=</span><span class="s1">''</span>
<span class="n">export</span> <span class="n">MNEMONIC</span><span class="o">=</span><span class="s1">''</span>
<span class="n">export</span> <span class="n">ETHERSCAN_TOKEN</span><span class="o">=</span><span class="s1">''</span>
</pre></div>
</div>
<p>首先是全节点的信息，如果你自己本地有全节点的话，可以不用配置，直接在部署测试中
写就好了，毕竟 brownie 使用的是 <code class="docutils literal notranslate"><span class="pre">web3.py</span></code>，和 <code class="docutils literal notranslate"><span class="pre">web3.js</span></code> 基本没差。其他的
配置都可以直接通过名字就知道其配置是干啥的，私钥，助记词，etherscan 的 token。</p>
</section>
<section id="brownie-compile">
<span id="id22"></span><h4 id="brownie-compile">编译<a class="headerlink" href="#brownie-compile" title="永久链接至标题">¶</a></h4>
<p>编译和其他的一样，都是后面加个 <code class="docutils literal notranslate"><span class="pre">compile</span></code> 就好了</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>brownie compile
</pre></div>
</div>
</section>
<section id="brownie-deploy">
<span id="id23"></span><h4 id="brownie-deploy">部署<a class="headerlink" href="#brownie-deploy" title="永久链接至标题">¶</a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>brownie run scripts/deploy.py
</pre></div>
</div>
<p>部署命令都可以手动指定网络的，通过 <code class="docutils literal notranslate"><span class="pre">--network</span> <span class="pre">&lt;network-name&gt;</span></code>。
这也是 brownie 一个优点，就是其默认内部集成了很多的网络，可以使用
<code class="docutils literal notranslate"><span class="pre">brownie</span> <span class="pre">networks</span> <span class="pre">list</span></code> 来查看。</p>
<p>以合约源文件为 <code class="docutils literal notranslate"><span class="pre">Hello.sol</span></code> 为例，其中 <code class="docutils literal notranslate"><span class="pre">deploy.py</span></code> 的如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/python3</span>

<span class="kn">from</span> <span class="nn">brownie</span> <span class="kn">import</span> <span class="p">(</span>
  <span class="n">config</span><span class="p">,</span>
  <span class="n">network</span><span class="p">,</span>
  <span class="n">accounts</span><span class="p">,</span>
  <span class="n">Hello</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">import</span> <span class="nn">eth_utils</span>

<span class="n">NON_FORKED_LOCAL_BLOCKCHAIN_ENVIROMENTS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"development"</span><span class="p">,</span> <span class="s2">"ganache"</span><span class="p">]</span>
<span class="n">LOCAL_BLOCKCHAIN_ENVIROMENTS</span> <span class="o">=</span> <span class="n">NON_FORKED_LOCAL_BLOCKCHAIN_ENVIROMENTS</span> <span class="o">+</span> <span class="p">[</span>
  <span class="s2">"mainnet-fork"</span><span class="p">,</span>
  <span class="s2">"binance-fork"</span><span class="p">,</span>
  <span class="s2">"matic-fork"</span><span class="p">,</span>
<span class="p">]</span>

<span class="k">def</span> <span class="nf">get_account</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">network</span><span class="o">.</span><span class="n">show_active</span><span class="p">()</span> <span class="ow">in</span> <span class="n">LOCAL_BLOCKCHAIN_ENVIROMENTS</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">accounts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  <span class="k">if</span> <span class="n">number</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">accounts</span><span class="p">[</span><span class="n">number</span><span class="p">]</span>
  <span class="k">if</span> <span class="n">network</span><span class="o">.</span><span class="n">show_active</span><span class="p">()</span> <span class="ow">in</span> <span class="n">config</span><span class="p">[</span><span class="s2">"networks"</span><span class="p">]:</span>
    <span class="k">return</span> <span class="n">accounts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s2">"wallets"</span><span class="p">][</span><span class="s2">"from_key"</span><span class="p">])</span>
  <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
  <span class="n">account</span> <span class="o">=</span> <span class="n">get_account</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Deploying to </span><span class="si">{</span><span class="n">network</span><span class="o">.</span><span class="n">show_active</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="n">hello</span> <span class="o">=</span> <span class="n">Hello</span><span class="o">.</span><span class="n">deploy</span><span class="p">({</span><span class="s2">"from"</span><span class="p">:</span> <span class="n">account</span><span class="p">})</span>
  <span class="c1"># hello = Hello.deploy(</span>
  <span class="c1">#   {"from": account},</span>
  <span class="c1">#   publish_source=config["networks"][network.show_active()]["verify"]</span>
  <span class="c1"># )</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Deployed to: </span><span class="si">{</span> <span class="n">hello</span><span class="o">.</span><span class="n">address</span> <span class="si">}</span><span class="s2">"</span><span class="p">)</span>

</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Hello.deploy()</span></code> 中 <code class="docutils literal notranslate"><span class="pre">Hello</span></code> 为合约名，需要从 brownie 中导入，
<code class="docutils literal notranslate"><span class="pre">deploy()</span></code> 中首先是要有合约构造时的参数，如果构造函数没有参数那就
不用写，然后后面就是跟对应的 transaction 中的属性了，如果想部署时
同时发布源代码，就使用 <code class="docutils literal notranslate"><span class="pre">publish_source</span></code> 来指定是否发布，
<code class="docutils literal notranslate"><span class="pre">publish_source</span></code> 的类型为 <code class="docutils literal notranslate"><span class="pre">boolean</span></code>，可以通过在配置文件中配置对应
网络的值。</p>
<blockquote>
<div><p>P.S. 这里需要注意的是，因为 Github 增加了其安全性，所以需要自己到
Github 上生成一下 Token，然后在 <code class="docutils literal notranslate"><span class="pre">.zshrc</span></code> / <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code> 中添加
<code class="docutils literal notranslate"><span class="pre">GITHUB_TOKNE="&lt;your-github-token&gt;"</span></code></p>
</div></blockquote>
<p>如果要与合约进行交互的话，就需要从 brownie 中导入 <code class="docutils literal notranslate"><span class="pre">Contract</span></code> 模块：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">brownie</span> <span class="kn">import</span> <span class="n">Contract</span>
</pre></div>
</div>
<p>然后构建一个 Contract 的对象：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hello_contract</span> <span class="o">=</span> <span class="n">Contract</span><span class="o">.</span><span class="n">from_abi</span><span class="p">(</span><span class="s2">"Hello"</span><span class="p">,</span> <span class="n">hello</span><span class="o">.</span><span class="n">address</span><span class="p">,</span> <span class="n">Hello</span><span class="o">.</span><span class="n">abi</span><span class="p">)</span>
</pre></div>
</div>
<p>部署后可以使用 <code class="docutils literal notranslate"><span class="pre">brownie</span> <span class="pre">gui</span></code> 查看对应合约的 opcode。这个我就看到文档可以这样
做，但是具体我没操作过，毕竟还没达到那个水平。</p>
<p>最后同样是附上官方文档： https://eth-brownie.readthedocs.io/en/stable/</p>
</section>
</section>
</section>
<section id="foundry">
<span id="id24"></span><h2 id="foundry">Foundry<a class="headerlink" href="#foundry" title="永久链接至标题">¶</a></h2>
<p>Foundry 是个用 rust 实现的 toolkit，用法和 Brownie 差不多。
要注意的一点就是 Foundry 是这个 toolkit 的名字，但是内部命令
不是 foundry，而是 <code class="docutils literal notranslate"><span class="pre">forge</span></code> 和 <code class="docutils literal notranslate"><span class="pre">cast</span></code> 两个命令。</p>
<section id="foundry-installation">
<span id="id25"></span><h3 id="foundry-installation">安装<a class="headerlink" href="#foundry-installation" title="永久链接至标题">¶</a></h3>
<p>官方提供的安装二进制的方法我在 M1 上失败了，所以我就从源代码
直接编译出来了。</p>
<p>官方的安装二进制的命令：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl -L https://foundry.paradigm.xyz <span class="p">|</span> bash
</pre></div>
</div>
<p>在从源代码编译安装之前，需要首先安装好 Rust 和 Cargo，
不然你怎么编译呢？</p>
<p>从源代码编译安装官方也提供了对应的命令：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cargo install --git https://github.com/foundry-rs/foundry --bins --locked
</pre></div>
</div>
</section>
<section id="foundry-usage">
<span id="id26"></span><h3 id="foundry-usage">使用<a class="headerlink" href="#foundry-usage" title="永久链接至标题">¶</a></h3>
<section id="foundry-init">
<span id="id27"></span><h4 id="foundry-init">初始化<a class="headerlink" href="#foundry-init" title="永久链接至标题">¶</a></h4>
<p>这些 toolkits 的初始化命令大同小异，这个因为是 rust 开发的，
所以就会继承 rust 的一些特性，比如，创建新项目可以直接指定
项目名。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>forge init hello
</pre></div>
</div>
<p>这条命令会在当前目录下创建一个 hello 的文件夹，文件夹的目录
结构为：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd hello
$ tree ./
./
├── foundry.toml
├── lib
│   └── ds-test
│       ├── LICENSE
│       ├── Makefile
│       ├── default.nix
│       ├── demo
│       │   └── demo.sol
│       └── src
│           └── test.sol
├── src
│   └── Contract.sol
└── test
    └── Contract.t.sol

6 directories, 8 files
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">foundry.toml</span></code>：配置文件</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lib</span></code>：存放一些依赖库、模版</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src</span></code>：存放合约源代码文件</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">test</span></code>：存放测试合约代码，一般都是 <code class="docutils literal notranslate"><span class="pre">ContractName.t.sol</span></code></p></li>
</ul>
<p>编译后会多出两个文件夹，一个是 <code class="docutils literal notranslate"><span class="pre">out</span></code>，里面存放的是合约的 abi
等文件，<code class="docutils literal notranslate"><span class="pre">cache</span></code> 就是一些缓存，重新编译时会检查里面的文件来进行
对应的编译。</p>
</section>
<section id="foundry-config">
<span id="id28"></span><h4 id="foundry-config">配置<a class="headerlink" href="#foundry-config" title="永久链接至标题">¶</a></h4>
<p>Foundry 的配置文件为 <code class="docutils literal notranslate"><span class="pre">foundry.toml</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">default</span><span class="p">]</span>
<span class="c1"># The source directory</span>
<span class="n">src</span> <span class="o">=</span> <span class="s1">'src'</span>
<span class="c1"># The test directory</span>
<span class="n">test</span> <span class="o">=</span> <span class="s1">'test'</span>
<span class="c1"># The artifact directory</span>
<span class="n">out</span> <span class="o">=</span> <span class="s1">'out'</span>
<span class="c1"># A list of paths to look for libraries in</span>
<span class="n">libs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'lib'</span><span class="p">]</span>
<span class="c1"># A list of remappings</span>
<span class="n">remappings</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># A list of deployed libraries to link against</span>
<span class="n">libraries</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Whether to cache builds or not</span>
<span class="n">cache</span> <span class="o">=</span> <span class="n">true</span>
<span class="c1"># Whether to ignore the cache</span>
<span class="n">force</span> <span class="o">=</span> <span class="n">false</span>
<span class="c1"># The EVM version by hardfork name</span>
<span class="n">evm_version</span> <span class="o">=</span> <span class="s1">'london'</span>
<span class="c1"># Override the Solidity version (this overrides `auto_detect_solc`)</span>
<span class="c1">#solc_version = '0.8.10'</span>
<span class="c1"># Whether or not Forge should auto-detect the solc version to use</span>
<span class="n">auto_detect_solc</span> <span class="o">=</span> <span class="n">true</span>
<span class="c1"># Disables downloading missing solc versions</span>
<span class="n">offline</span> <span class="o">=</span> <span class="n">false</span>
<span class="c1"># Enables or disables the optimizer</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">true</span>
<span class="c1"># The number of optimizer runs</span>
<span class="n">optimizer_runs</span> <span class="o">=</span> <span class="mi">200</span>
<span class="c1"># The verbosity of tests</span>
<span class="n">verbosity</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># A list of ignored solc error codes</span>
<span class="n">ignored_error_codes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># The number of fuzz runs for fuzz tests</span>
<span class="n">fuzz_runs</span> <span class="o">=</span> <span class="mi">256</span>
<span class="c1"># The max number of individual inputs that may be rejected before a fuzz test aborts</span>
<span class="n">fuzz_max_local_rejects</span> <span class="o">=</span> <span class="mi">65536</span>
<span class="c1"># The max number of combined inputs that may be rejected before a fuzz test aborts</span>
<span class="n">fuzz_max_global_rejects</span> <span class="o">=</span> <span class="mi">1024</span>
<span class="c1"># Whether or not to enable `cheats.ffi`</span>
<span class="n">ffi</span> <span class="o">=</span> <span class="n">false</span>
<span class="c1"># The address of `msg.sender` in tests</span>
<span class="n">sender</span> <span class="o">=</span> <span class="s1">'0x00a329c0648769a73afac7f9381e08fb43dbea72'</span>
<span class="c1"># The address of `tx.origin` in tests</span>
<span class="n">tx_origin</span> <span class="o">=</span> <span class="s1">'0x00a329c0648769a73afac7f9381e08fb43dbea72'</span>
<span class="c1"># The initial balance of the test contract</span>
<span class="n">initial_balance</span> <span class="o">=</span> <span class="s1">'0xffffffffffffffffffffffff'</span>
<span class="c1"># The block number we are at in tests</span>
<span class="n">block_number</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># The chain ID we are on in tests</span>
<span class="n">chain_id</span> <span class="o">=</span> <span class="mi">99</span>
<span class="c1"># The gas limit in tests</span>
<span class="n">gas_limit</span> <span class="o">=</span> <span class="mi">9223372036854775807</span>
<span class="c1"># The gas price in tests (in wei)</span>
<span class="n">gas_price</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># The block basefee in tests (in wei)</span>
<span class="n">block_base_fee_per_gas</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># The address of `block.coinbase` in tests</span>
<span class="n">block_coinbase</span> <span class="o">=</span> <span class="s1">'0x0000000000000000000000000000000000000000'</span>
<span class="c1"># The block timestamp in tests</span>
<span class="n">block_timestamp</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># The block difficulty in tests</span>
<span class="n">block_difficulty</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># A list of contracts to output gas reports for</span>
<span class="n">gas_reports</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"*"</span><span class="p">]</span>
<span class="c1"># Enables or disables RPC caching when forking</span>
<span class="n">no_storage_caching</span> <span class="o">=</span> <span class="n">false</span>
<span class="c1"># Caches storage retrieved locally for certain chains and endpoints</span>
<span class="c1"># Can also be restricted to multiple chains</span>
<span class="c1"># By default only remote endpoints will be cached</span>
<span class="c1"># To disable storage caching, set `no_storage_caching = true`</span>
<span class="n">rpc_storage_caching</span> <span class="o">=</span> <span class="p">{</span> <span class="n">chains</span> <span class="o">=</span> <span class="s2">"all"</span><span class="p">,</span> <span class="n">endpoints</span> <span class="o">=</span> <span class="s2">"remote"</span> <span class="p">}</span>
<span class="c1"># Extra output to include in the contract's artifact.</span>
<span class="n">extra_output</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Extra output to write to separate files.</span>
<span class="n">extra_output_files</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Use the given hash method for the metadata hash that is appended</span>
<span class="c1"># to the bytecode.</span>
<span class="c1"># The metadata hash can be removed from the bytecode by setting "none"</span>
<span class="n">bytecode_hash</span> <span class="o">=</span> <span class="s2">"ipfs"</span>
<span class="c1"># If enabled, the Solidity compiler is instructed to generate bytecode</span>
<span class="c1"># only for the required contracts. This can reduce compile time</span>
<span class="c1"># for `forge test`, but is experimental.</span>
<span class="n">sparse_mode</span> <span class="o">=</span> <span class="n">false</span>
</pre></div>
</div>
<p>上面的配置文件包含了大部分参数，注意也讲解的很清楚，这里只想介绍一下
<code class="docutils literal notranslate"><span class="pre">remapping</span></code>。因为现在大部分合约都会调用 <code class="docutils literal notranslate"><span class="pre">OpenZeppelin</span></code> 的库，所
以本文档中的第三方库都是以 <code class="docutils literal notranslate"><span class="pre">OpenZeppelin</span></code> 的为例。</p>
<p>不同于上面三个 toolkit，foundry 安装三方库不是使用 npm 安装保存
在项目目录下的，而是通过 <code class="docutils literal notranslate"><span class="pre">forge</span></code> 进行安装的：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>forge install openzeppelin/openzeppelin-contracts
</pre></div>
</div>
<p>然后再在配置文件中添加 <code class="docutils literal notranslate"><span class="pre">remmappings</span></code> 的配置:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">remappings</span><span class="o">=</span> <span class="p">[</span><span class="s1">'@openzeppelin=lib/openzeppelin-contracts'</span><span class="p">]</span>
</pre></div>
</div>
<p>这个其实和 brownie 比较类似，都是去 Github 上下载源代码。当然，
测试合约中就是这样调用的，也可以将测试合约调用的库进行
<em>remapping</em> 一下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">remappins</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s1">'@openzeppelin=lib/openzeppelin-contracts'</span><span class="p">,</span>
  <span class="s1">'@ds-test=lib/ds-test/src/'</span>
<span class="p">]</span>
</pre></div>
</div>
<p>然后测试合约中的 <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">"ds-test/test.sol";</span></code> 就可以改写成
<code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">"@ds-test/test.sol";</span></code>。</p>
<p>好像有点脱裤子放屁的感觉，因为测试合约中本生就是调用本地的，无所谓了，
这样更符合标准一点，毕竟 <code class="docutils literal notranslate"><span class="pre">ds-test</span></code> 是创建项目时默认添加的库，第三方
库的引用还是统一用 Solidity 的标准的好。</p>
<blockquote>
<div><p>P.S. 就是不知道为什么 truffle 不支持 remapping。</p>
</div></blockquote>
</section>
<section id="foundry-compile">
<span id="id29"></span><h4 id="foundry-compile">编译<a class="headerlink" href="#foundry-compile" title="永久链接至标题">¶</a></h4>
<p>和上面三个不同的是，foundry 的编译用的是 build 命令，这和其实现
有关，毕竟是 rust 写的。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>forge build
</pre></div>
</div>
</section>
<section id="foundry-deploy">
<span id="id30"></span><h4 id="foundry-deploy">部署<a class="headerlink" href="#foundry-deploy" title="永久链接至标题">¶</a></h4>
<p>Foundry 的部署上面三个要稍微繁琐一点，不支持脚本。没办法，编译型语言和
解释型语言的差异。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ forge create --rpc-url &lt;your-rpc-url&gt; <span class="se">\</span>
    --constructor-args <span class="s2">"Arg1"</span> <span class="s2">"Arg2"</span> ... <span class="se">\</span>
    --private-key &lt;your-private-key&gt; <span class="se">\</span>
    src/&lt;ContractSourceFileName&gt;:&lt;ContractName&gt;
</pre></div>
</div>
<p>这些关键信息需要自己手动指定，配置文件中也配置不了。</p>
<p>如果要将合约代码开源的话，需要使用 <code class="docutils literal notranslate"><span class="pre">forge</span> <span class="pre">verify-contract</span></code> 命令：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ forge verify-contract --chain-id &lt;chainId&gt; <span class="se">\</span>
    --num-of-optimizations &lt;Optimization Number&gt; <span class="se">\</span>
    --constructor-args <span class="se">\</span>
    <span class="o">(</span>cast abi-encode <span class="s2">"constructor(arg1, arg2, ...)"</span> <span class="s2">"Arg1"</span> <span class="s2">"Arg2"</span><span class="o">)</span> <span class="se">\</span>
    --compiler-version &lt;solc version&gt; <span class="se">\</span>
    &lt;Contract Address&gt; <span class="se">\</span>
    src/&lt;ContractSourceFileName&gt;:&lt;ContractName&gt; <span class="se">\</span>
    &lt;your-etherscan-api-key&gt;
</pre></div>
</div>
<p>Whoo, 这个参数有够多的，没有脚本语言舒服，希望后续可以放到配置文件中吧。</p>
</section>
<section id="id31">
<h4 id="id31">交互<a class="headerlink" href="#id31" title="永久链接至标题">¶</a></h4>
<p>如果要与链进行交互的话，Foundry 使用的是另一个命令：<code class="docutils literal notranslate"><span class="pre">cast</span></code>。</p>
<p>这种编译型语言就是这点不太方便，不能像解释型那样直接写一个脚本然后运行就
完事。所以，如果要和链上的合约交互的话，也需要指定一些信息（个人感觉
这个可以通过 rust 的 web3 写个 lib 来调用，不过这个库更新不是很频繁）。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ cast call &lt;contract-address&gt; &lt;contract-method-signature&gt; <span class="se">\</span>
    --rpc-url &lt;your-rpc-provider-url&gt;
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">cast</span></code> 还可以对 opcode 进行解码，不过前提是你要有合约中的方法的原型：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ bash 4byte-decode &lt;op-code&gt; &lt;contract-method-signature&gt;
</pre></div>
</div>
<p>更多的去官方文档上查看吧。</p>
<p>官网文档：https://book.getfoundry.sh/getting-started/installation.html</p>
</section>
</section>
</section>
<section id="id32">
<h2 id="id32">总结<a class="headerlink" href="#id32" title="永久链接至标题">¶</a></h2>
<p>上面的使用中我都没有介绍怎么进行测试，因为我都是直接部署到测试网上，然后进行
交互式的验证，反正测试网上不要钱，直接测就好，或者本地起一个 ganache，也可以
直接测试，至于具体怎么测，那肯定是看具体的合约是什么了。你已经步入 web3 的开
发了，是个成熟的开发者了，我相信你自己会对自己的合约设计一些 TC（Test Case）
的。你要是自己懒得测，被科学家们给割了那就只能是怪自己咯。</p>
<p>以上，简单的介绍了一下目前我所接触的一些智能合约开发所用到的 toolkit，
下面就做个简单的对比吧。</p>
<table>
<thead>
<tr class="row-odd"><th class="text-left head"><p>Toolkits</p></th>
<th class="text-center head"><p>实现语言</p></th>
<th class="text-center head"><p>上手难度</p></th>
<th class="head"><p>优点</p></th>
<th class="head"><p>缺点</p></th>
<th class="head"><p>总体评分</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>Hardhat</p></td>
<td class="text-center"><p>JavaScript</p></td>
<td class="text-center"><p>1   星</p></td>
<td><p>文档全，用户多</p></td>
<td><p>无</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Truffle</p></td>
<td class="text-center"><p>JavaScript</p></td>
<td class="text-center"><p>1   星</p></td>
<td><p>使用简单</p></td>
<td><p>项目不再更新，可配置性不高</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>Brownie</p></td>
<td class="text-center"><p>Python</p></td>
<td class="text-center"><p>2   星</p></td>
<td><p>使用方便，集成功能较多</p></td>
<td><p>Python 在速度上比较慢</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>Foundry</p></td>
<td class="text-center"><p>Rust</p></td>
<td class="text-center"><p>2.5 星</p></td>
<td><p>一个字，快</p></td>
<td><p>部署和交互比较麻烦</p></td>
<td><p>3.5</p></td>
</tr>
</tbody>
</table>
<p>对于刚接触 Web3 的新手来说，最推荐的还是 Hardhat，如果是说有
Python 背景的人，那么 Brownie 是个很不错的选择，毕竟不用再去学
习 JavaScript，直接上手。如果是有 Rust 背景，且比较在意速度和
只想用 Solidity 写合约已经测试，那么 Foundry 是你的不二之选。
要知道，没有最好，只有最适合，所以选择时不要过于纠结，选一个适合
自己的，然后专注合约的开发就好了，毕竟工具只是辅助而已，如果你
像 hardcore 一点，那么不用这些 toolkit 也是可以的，直接手动
编译成 abi，然后调用 web3 的库直接部署也是可以的。</p>
<blockquote>
<div><p>The choice is yours.</p>
</div></blockquote>
<p>好了，所有的介绍就到这里了。</p>
<p>One more thing，一个个人觉得很不错的资源合集的链接：</p>
<p>https://github.com/OpenZeppelin/awesome-openzeppelin</p>
<p>Happy Crypting :)</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="rust-web3-tutorial.html" title="Rust Web3 Tutorial"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Rust Web3 Tutorial </span>
              </div>
            </a>
          
          
            <a href="GPG-on-Mac.html" title="GPG Suit for Apple Mail on Mac OS"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> GPG Suit for Apple Mail on Mac OS </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2020-2022, Yuqi Liu.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>